!function(s){var e,t,n=s("body"),a=s("#assessment-container"),o=s("#assessment-holder"),i=s("#courseplayer video.player"),r=s(".toc-container"),d=function(s){switch(s){case"pre":return 1;case"post":return 2;default:return 4}};r.on("click",".assessment-item",function(a){var r=s(this),m=r.closest("li"),c=r.data("entityId");e=r.data("assessmentId"),t=d(m.data("assessment-type")),i.length&&i.get(0).pause(),s(".toc-items .video-transcripts").remove(),s(".toc-items li").removeClass("current"),m.addClass("current"),s.get("/ajax/assessment/"+c+"/"+e+"?assessmentType="+t).done(function(s){o.length&&s.html&&s.html.length>0&&(o.html(s.html),n.trigger("toggle.player.container",["assessment-container"]))}).error(function(e){s("#banner-thumbnail").is(":visible")&&s("#banner-thumbnail").hide(),i.length&&i.get(0).play()})}),a.length&&(a.on("click","#start-assessment, .retake-assessment",function(){var s=null;s=(new Date).getTime(),o.data("session-id",s),a.trigger("get.first.question",[s])}),a.on("click",".skip-to-next-chapter",function(){i.trigger("next")}),a.on("click",".next",function(){var n=s(".assessment-section"),a=n.data("currentQuesId"),i=n.data("last-ques")===!0,r=o.data("session-id");i?s.get("/ajax/assessment/results/"+e+"?sessionId="+r+"&assessmentType="+t).done(function(t){t.html&&t.html.length>0&&(o.html(t.html),s('.assessment-watched-cont[data-assessment-id="'+e+'"]').find("i").addClass("checkmark"),"undefined"!=typeof opener&&opener&&s('.assessment-watched-cont[data-assessment-id="'+e+'"]',window.opener.document).find("i").addClass("checkmark"))}):s.get("/ajax/assessment/next/"+e+"/"+a+"?sessionId="+r+"&assessmentType="+t).done(function(s){s.html&&s.html.length>0&&o.html(s.html)})}),a.on("click",".prev",function(){var n=s(".assessment-section"),a=n.data("currentQuesId"),i=o.data("session-id");s.get("/ajax/assessment/prev/"+e+"/"+a+"?sessionId="+i+"&assessmentType="+t).done(function(s){s.html&&s.html.length>0&&o.html(s.html)})}),a.on("click",".last",function(){var n=s(".assessment-section"),a=n.data("currentQuesId"),i=o.data("session-id");s.get("/ajax/assessment/last/"+e+"/"+a+"?sessionId="+i+"&assessmentType="+t).done(function(s){s.html&&s.html.length>0&&o.html(s.html)})}),a.on("click","#assessment-question .optn",function(){var n=s(this),a=s(".assessment-section"),i=a.data("currentQuesId"),r=n.data("optionId"),d=o.data("session-id");s.get("/ajax/assessment/validate/"+e+"/"+i+"/"+r+"?sessionId="+d+"&assessmentType="+t).done(function(e){if(e.status&&"ok"==e.status){if(e.isCorrectAnswer)n.addClass("correct"),n.find(".opt-icon").addClass("checkmark");else{var t=s('.answers [data-option-id="'+e.correctAnswer.OptionId+'"]');n.addClass("wrong"),n.find(".opt-icon").addClass("close-x"),t.addClass("correct"),t.find(".opt-icon").addClass("checkmark")}s("#assessment-question .optn").attr("disabled","disabled"),s(".next").removeAttr("disabled")}else console.log(e.message)})}),n.on("click","#resume-assessment",function(e){var t=o.data("session-id");s("#start-assessment").popover("destroy"),a.trigger("resume.assessment",[t])}),n.on("click","#restart-assessment",function(e){var t=o.data("session-id");s("#start-assessment").popover("destroy"),a.trigger("restart.assessment",[t])}),a.on("get.first.question",function(n,a){s.get("/ajax/assessment/start/"+e+"?sessionId="+a+"&assessmentType="+t).done(function(e){e.isIncomplete?(o.data("session-id",e.prevSessionId),s("#start-assessment").popover({html:!0,animation:!1,container:"#assessment-holder",template:'<div class="popover dark-pop resume-assessment-popover" role="tooltip"><div class="arrow"></div><div class="popover-content"></div></div>',content:function(){return s(".popover").not(this).popover("hide"),s("#resume-assessments-popover").clone().removeClass("hide").html()}}),s("#start-assessment").popover("show")):e.html&&e.html.length>0&&o.html(e.html)})}),a.on("resume.assessment",function(n,a){s.get("/ajax/assessment/resume/"+e+"/"+a+"?assessmentType="+t).done(function(s){s.html&&s.html.length>0&&o.html(s.html)})}),a.on("restart.assessment",function(t,n){s.get("/ajax/assessment/session/end/"+e+"/"+n).done(function(s){n=(new Date).getTime(),o.data("session-id",n),a.trigger("get.first.question",[n])})}),n.on("click",function(e){s(".resume-assessment-popover").not(this).popover("destroy")}))}(jQuery);